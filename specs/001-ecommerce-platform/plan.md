# Implementation Plan: Smart Merchant Command Center

**Branch**: `001-ecommerce-platform` | **Date**: 2026-02-03 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-ecommerce-platform/spec.md`

## Summary

Build a complete e-commerce platform with a merchant dashboard for product/order management and analytics, plus a customer storefront with product browsing, variant selection, cart, and checkout. The system features automatic inventory management (decrements on purchase, restores on cancellation), smart notifications via email, and a full product variant system with SKU-level inventory tracking.

**Technical Approach**: MERN stack (MongoDB, Express.js, React, Node.js) with Stripe for payments, SendGrid for transactional emails, Cloudinary for image management, deployed on Vercel (frontend) and Render (backend + cron jobs).

## Technical Context

**Language/Version**: Node.js 20 LTS (backend), JavaScript ES2022+ (both frontend and backend)
**Primary Dependencies**:
- Backend: Express.js 4.x, Mongoose 8.x, Stripe SDK, SendGrid SDK, Cloudinary SDK
- Frontend: React 18, Vite 5, React Router 6, TanStack Query, Redux Toolkit (state), Tailwind CSS
**Storage**: MongoDB Atlas (free tier M0, 512MB)
**Testing**: Vitest (unit/integration), Playwright (E2E), Supertest (API)
**Type Checking**: JSDoc annotations + VSCode IntelliSense (no TypeScript compilation)
**Target Platform**: Web (responsive, mobile-first)
**Project Type**: Web application (separate frontend/backend)
**Deployment**:
- Frontend: Vercel (automatic deployments from main branch)
- Backend: Render Web Service (Node.js)
- Cron Jobs: Render Cron Jobs (daily summaries)
**Performance Goals**:
- Page load < 3 seconds (SC-001, SC-004)
- API responses < 500ms p95
- 100 concurrent users browsing, 10 concurrent checkouts (SC-006)
**Constraints**:
- Free tier limits: MongoDB 512MB, SendGrid 100 emails/day (upgrade path available)
- Vercel serverless function timeout: 10s (not applicable - backend on Render)
**Scale/Scope**: Single merchant store, ~1000 products, ~100 orders/day initial target

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Evidence |
|-----------|--------|----------|
| I. AI-Human Collaboration | ✅ PASS | All decisions documented, commit messages will show AI contributions |
| II. Technical Excellence | ✅ PASS | Separation of concerns (frontend/backend), API-first design, JSDoc for type hints |
| III. Security & Data Integrity | ✅ PASS | Stripe handles PCI, env vars for secrets, input validation planned, soft deletes for products |
| IV. User Experience | ✅ PASS | Mobile-first with Tailwind, loading states planned, accessible components |
| V. Performance & Scalability | ✅ PASS | MongoDB indexes planned, Cloudinary CDN for images, stateless backend on Render |

**Development Standards Compliance:**
- Conventional commits enforced
- API contracts documented before implementation (see contracts/)
- README will enable < 10 min setup

**Quality Gates:**
- ESLint + Prettier for linting
- JSDoc type annotations for IntelliSense
- Vitest for unit tests
- GitHub Actions CI pipeline planned

## Project Structure

### Documentation (this feature)

```text
specs/001-ecommerce-platform/
├── plan.md              # This file
├── research.md          # Technology decisions and rationale
├── data-model.md        # MongoDB schemas and relationships
├── quickstart.md        # Developer setup guide
├── contracts/           # API endpoint specifications
│   ├── auth.md
│   ├── products.md
│   ├── cart.md
│   ├── orders.md
│   ├── analytics.md
│   └── notifications.md
└── tasks.md             # Generated by /speckit.tasks
```

### Source Code (repository root)

```text
backend/
├── src/
│   ├── config/          # Environment, database, third-party configs
│   ├── models/          # Mongoose schemas
│   ├── routes/          # Express route handlers
│   ├── controllers/     # Business logic
│   ├── services/        # External integrations (Stripe, SendGrid, Cloudinary)
│   ├── middleware/      # Auth, validation, error handling
│   ├── utils/           # Helpers, constants
│   └── index.js         # App entry point
├── tests/
│   ├── unit/
│   └── integration/
├── package.json
├── jsconfig.json        # For VSCode IntelliSense
└── .env.example

frontend/
├── src/
│   ├── components/      # Reusable UI components
│   │   ├── ui/          # Base components (Button, Input, Card, etc.)
│   │   ├── layout/      # Header, Footer, Sidebar
│   │   └── features/    # Feature-specific components
│   ├── pages/           # Route pages
│   │   ├── storefront/  # Customer-facing pages
│   │   └── dashboard/   # Merchant dashboard pages
│   ├── hooks/           # Custom React hooks
│   ├── services/        # API client functions
│   ├── store/           # Redux store and slices
│   ├── utils/           # Helpers
│   └── main.jsx         # App entry point
├── tests/
│   ├── unit/
│   └── e2e/
├── package.json
├── jsconfig.json        # For VSCode IntelliSense
├── vite.config.js
├── tailwind.config.js
└── .env.example
```

**Structure Decision**: Web application structure with separate `frontend/` and `backend/` directories. Frontend deployed to Vercel, backend deployed to Render. Monorepo structure allows shared TypeScript types via a `shared/` package if needed later.

## Third-Party Integrations

| Service | Purpose | Free Tier | Upgrade Path |
|---------|---------|-----------|--------------|
| MongoDB Atlas | Database | 512MB (M0) | M10 ($57/mo) for production |
| Stripe | Payments | 2.9% + $0.30/txn | Volume discounts available |
| SendGrid | Email | 100/day | Essentials ($19.95/mo) for 50k/mo |
| Cloudinary | Images | 25GB storage, 25GB bandwidth | Plus ($99/mo) for more |
| Vercel | Frontend hosting | 100GB bandwidth | Pro ($20/mo) for teams |
| Render | Backend hosting | 750 hrs/mo | Starter ($7/mo) for always-on |

## Complexity Tracking

> No constitution violations requiring justification. Architecture follows all principles.

| Decision | Rationale | Simpler Alternative Considered |
|----------|-----------|-------------------------------|
| JavaScript + JSDoc | Faster development, no build step for types, VSCode IntelliSense via JSDoc | TypeScript - more setup overhead for this project scale |
| Separate frontend/backend repos structure | Independent deployment, clear boundaries | Monolith - rejected per constitution principle II |
| Redux Toolkit | Industry standard, excellent DevTools, middleware ecosystem | Zustand - simpler but less ecosystem support |
| Mongoose over native MongoDB driver | Schema validation, middleware, better DX | Native driver - rejected for productivity |
